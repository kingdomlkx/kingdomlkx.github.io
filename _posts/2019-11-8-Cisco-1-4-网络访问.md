---
title: Cisco-1-4 网络访问
auther: 雁引愁心去
layout: post
order: 4
---




## 第四章 网络访问 ##




### 简介 ###

在发送设备上，数据链路层的作用是准备数据以供传输，并控制该数据访问物理介质的方式。但是，物理层通过将代表数据的二进制数字编码成信号来控制数据传送到物理介质的方式。
在接收端，物理层通过连接介质接收信号。在将信号解码为数据后，物理层会将帧传递到数据链路层以便接受和处理。

本章首先介绍物理层的常用功能以及用于管理本地介质中数据传输的标准和协议。本章还将介绍数据链路层的功能以及与其相关的各种协议。

### 第一节 物理层协议 ###

1. 网络接口卡

  - 网络接口卡 (NIC) 将设备连接到网络。以太网网卡用于有线连接（如图 1 所示），而 WLAN（无线局域网）网卡用于无线连接。
  - 无线设备

    - 无线设备会由于它与无线接入点之间距离的增加而使其性能下降
    - 所有无线设备必须共享对连接到无线接入点的无线电波的访问。这意味着同时访问网络的无线设备越多，网络速度就会越差。
  - 有线设备  

    有线设备不必与其他设备共享其对网络的访问。每个有线设备都通过自己的以太网电缆建立单独的通信通道。

2. 物理层

  OSI 物理层通过网络介质传输构成数据链路层帧的位。该层从数据链路层接收完整的帧，并将这些帧编码为一系列信号，传输到本地介质上。经过编码的位构成了帧，这些位可以被终端设备或中间设备接收。   

  数据从源节点向目的节点传输的过程如下：
  - 用户 _数据_ 在传输层进行 _分段(数据段)_，由网络层放入 _数据包_，再由数据链路层封装成 _帧_ 。

  - 物理层将帧编码，并创建电子、光纤或无线电波信号来代表每个帧中的位。
  - 然后，将这些信号逐个发送到介质上。
  - 目的节点物理层从介质上检索每个信号，将其还原为位表示方式，然后将这些位作为一个完整的帧向上传递到数据链路层。

### 第二节 网络介质 ###

  1. 物理层介质

  网络介质有三种基本形式。物理层为每种介质制定的位的表示方式及分组如下：

    - 铜缆：信号为电脉冲模式。

    - 光缆：信号为光模式。
    - 无线：信号为微波传输模式。

  2. 函数       
物理层标准管理三个功能区:

    - 物理硬件      

      物理组件是电子硬件设备、介质和其他连接器，它们用于传输和承载用于表示位的信号。网卡、接口和连接器、电缆材料以及电缆设计等硬件组件均按照物理层的相关标准进行规定。

    - 编码        

      编码或线路编码是一种将数据位流转换为预定义“代码”的方法。这些代码就是位组，用于提供一种可预测模式，以便发送者和接收者均能识别。换句话说，编码是用于表示数字信息的方法或模式。

    - 信令      

      物理层必须在介质上生成代表“1”和“0”的电信号、光信号或无线信号。表示位的方法称为信令方法。物理层标准必须定义哪种类型的信号代表“1”，而哪种类型的信号代表“0”。

  3. 带宽和吞吐量       

    物理层必须在介质上生成代表“1”和“0”的电信号、光信号或无线信号。表示位的方法称为信令方法。物理层标准必须定义哪种类型的信号代表“1”，而哪种类型的信号代表“0”。

    - __带宽是介质承载数据的能力。数字带宽可以测量在给定时间内从一个位置流向另一个位置的数据量__ .

    多种因素的结合，决定了网络的实际带宽：

    - 物理介质的属性
    - 信令和检测网络信号所选用的技术
    - 吞吐量是给定时段内通过介质传输的位的量度。

    由于各种因素的影响，吞吐量经常与物理层实施中指定的带宽不符。许多因素会影响吞吐量，包括：

    - 流量大小
    - 流量类型
    - 从源通往目的地的过程中遇到的网络设备数所产生的延时。

    在拥有多个网段的网际网络或网络中，吞吐量不能超过从源到目的地之间路径的最低链路速度。

  4. 铜缆

  - 铜缆特征

  铜介质受到距离和信号干扰的限制。在铜缆中，通过电脉冲传输数据。目的设备网络接口中的探测器接收的信号必须可成功解码为与发送的信号相符。但是，信号传输的距离越长，信号下降就越多。 这称为信号衰减。    

  电脉冲的时间和电压值易受两个干扰源的干扰

    - 电磁干扰(EMI)或射频干扰(RFI)
    - 串扰
    - 铜介质

    网络中使用的铜介质有三种主要类型：

    - 非屏蔽双绞线 (UTP)
    - 屏蔽双绞线 (STP)
    - 同轴电缆

这些电缆用于 LAN 上节点和基础设施设备（如交换机、路由器和无线接入点）的互连    

  - 非屏蔽双绞线电缆  

    非屏蔽双绞线 (UTP) 布线是最常用的网络介质。通过 __RJ-45__ 连接器端接的 UTP 布线用于网络主机与中间网络设备的互连，例如交换机和路由器。

    在 LAN 中，UTP 电缆由四对有彩色标记的电线组成。这些电线绞合在一起，并用软塑料套包裹，以避免较小的物理损坏。电线的绞合有助于防止其他电线的信号干扰。

  - 屏蔽双绞线电缆  

    屏蔽双绞线 (STP) 比 UTP 布线提供的噪音防护更好。但是，与 UTP 电缆相比，STP 电缆更加昂贵而且不易安装。和 UTP 相同，STP 也使用 RJ-45 连接器。  

    STP 电缆结合屏蔽技术来应对 EMI 和 RFI，使用电线绞合技术来应对串扰。为了充分利用屏蔽的优势，STP 电缆使用特殊屏蔽 STP 数据连接器进行端接。如果电缆接地不正确，屏蔽就相当于一个天线，会接听多余信号。
  - 同轴电缆

    同轴电缆，或简称同轴，由于它的两根导线分享同一个轴而得名。如图所示，同轴电缆包括：   

    - 一根用于传输电子信号的铜导线。

    - 包裹着铜导线的柔软的塑料绝缘层。
    - 绝缘材料的表皮是铜线编织或金属箔，作用相当于电路中的第二条电线，而且还可作为内部导体的屏蔽层。该第二层或屏蔽层还可减少许多外部电磁干扰。
    - 整个电缆由一层电缆表皮覆盖，使其免于较小的物理损坏。  
在以下情形中仍采用同轴电缆设计：
    - 无线安装：同轴电缆将天线连接到无线设备。同轴电缆可传送天线和无线电设备之间的射频 (RF) 能量。
    - 有线互联网安装：电缆服务提供商通过使用光缆替换同轴电缆部分并支持放大原理来为其客户提供互联网连接。但是，客户驻地的布线仍采用同轴电缆
同轴连接器:
    - BNC
    - N型
    - F型

5. UTP布线

  ![UTP电缆类型](//assets/images/cisco1/4-UTP电缆类型.png)

  - UTP布线属性

    在用作网络介质时，非屏蔽双绞线 (UTP) 由四对有彩色标记的铜线组成。

    UTP 电缆并不使用屏蔽层来对抗 EMI 和 RFI 的影响。他们可以通过以下方式来减少串扰的负面影响：
    - 抵消  
    当电路中的两根电线紧密排列时，彼此的磁场正好相反。
    - 变化每个线对中的绞合数量  

  - UTP布线标准

    - 3类电缆    

      用于语音通信

    - 5类和5e类电缆    

      用于数据传输100Mb/s  ~ 1000Mb/s

    - 6类电缆

      用于数据传输1000Mb/s ~ 10Gb/s

  - UTP连接器

    UTP 电缆的端头通常为 RJ-45 连接器。该连接器可用于多种物理层规范，以太网就是其中之一。TIA/EIA-568 标准描述为以太网电缆进行引脚分配（引出线）的电线颜色标记。

  - UTP电缆类型

    根据不同的布线约定，不同的场合可能需要使用不同的 UTP 电缆。这意味着要按照不同的顺序将电缆中的单个电线连接到 RJ-45 连接器的不同引脚组中。T568A与T568B两个标准.

    以下是通过使用指定的布线约定得到的主要电缆类型：

    - 以太网直通电缆：最常见的网络电缆类型。它通常用于主机到交换机和交换机到路由器的互连。即 __用于连接不同设备__.

    - 以太网交叉电缆：__用于互连相似设备__ 的电缆。例如，交换机到交换机、主机到主机或路由器到路由器的连接。
    - 全反电缆：思科专有电缆，用于工作站到路由器或交换机控制台端口的连接。

6.  光纤布线
  - 光纤布线属性

      与其他网络介质相比，光缆能够以更远的距离和更高的带宽传输数据。不同于铜线，光缆传输信号的衰减更少，并且完全不受 EMI 和 RFI 影响。光纤常用于互连网络设备。

      ![光纤介质电缆](/assets/images/cisco1/4-光纤介质电缆设计.png)

      目前光纤布线用于四类行业：

      - 企业网络：用于主干布线和基础设施设备互连。

      - 光纤到户 (FTTH)：用于为家庭和小型企业提供不间断宽带服务。
      - 长距离传输网络：由服务提供商用于连接国家/地区与城市。
      - 水下有线网络：用于提供可靠高速、高容量的网络解决方案，使其在深度与横跨海洋的距离相当的严酷海下环境中仍能生存。 点击 此处 查看描绘海底电缆位置的电信地理地图。
  - 光纤介质的类型
      光缆通常分为两种类型：

      - 单模光纤 (SMF)：包含一个极小的芯，使用昂贵的激光技术来发送单束光，如图 1 所示。普遍用于跨越数百千米的长距离传输，例如应用于长途电话和有线电视中的光纤。

      ![单模](/assets/images/cisco1/4-光纤介质单模.png)

      - 多模光纤 (MMF)：包含一个更大的芯，使用 LED 发射器发送光脉冲。具体而言，LED 发出的光从不同角度进入多模光纤，如图 2 所示。普遍用于 LAN 中，因为它们可以由低成本的 LED 提供支持。它可以通过长达 550 米的链路提供高达 10 Gb/s 的带宽。

      ![多模](/assets/images/cisco1/4-光纤介质多模.png)

      多模和单模光纤之间的主要区别之一就是色散的数量。色散是指光脉冲在时间上的分布。色散越多，信号强度的减弱就越快
  - 光纤连接器
      - ST接头
      - SC接头
      - LC接头
      - 双工多模LC接头
    人们使用不同颜色来区分单模和多模接插线。__黄色表皮的是单模光缆__，__橙色（或浅绿色）的是多模光缆__。

7. 无线介质

  无线介质使用无线电或微波频率来承载代表数据通信二进制数字的电磁信号.

  关于无线网络有一些关注重点，包括：
  -
      - 覆盖面积
      - 干扰
      - 安全性
      - 共享介质

  - 无线标准
      - WIFI
      - Bluetooth
      - WiMAX

  - 无线LAN
      - 无线接入点(AP)
      - 无线网卡适配器

### 第三节 数据链路层协议 ###

1. 数据链路层的用途

  OSI 模型的数据链路层（第 2 层），负责以下事项：
  -
    - 允许上层访问介质

    - 接受第 3 层数据包，并将它们打包为帧
    - 为物理网络准备网络数据
    - 控制数据在介质中的放置和接收方式
    - 在物理网络介质（例如 UTP 或光纤）中的节点之间交换帧
    - 接收数据包并将其传输给上层协议
    - 执行错误检测

    数据链路层有效分隔在数据包通过上层通信进程转发时出现的介质转换。数据链路层接收数据包并将数据包传输到上层协议，本例中为 IPv4 或 IPv6。该上层协议无需知道通信使用何种介质。

  - 数据链路子层

  ![数据链路子层](/assets/images/cisco1/4-数据链路子层.png)

    数据链路层可以拆分成两个子层：

    - 逻辑链路控制 (LLC) - 这一较高子层与网络层通信。它放入帧中的信息用于确定帧所使用的网络层协议。此信息允许多个第 3 层协议（如 IPv4 和 IPv6）使用相同的网络接口和介质。

    - 介质访问控制 (MAC) - 这一较低子层定义了硬件执行的介质访问流程。它提供数据链路层编址和对各种网络技术的访问。

2. 介质访问控制

  第 2 层协议指定了将数据包封装成帧的过程，以及用于将已封装数据包放置到各介质上和从各介质获取已封装数据包的技术。用于将帧放置到介质上和从介质获取帧的技术称为 _介质访问控制方法_。

  ![介质访问控制](/assets/images/cisco1/4-介质访问控制.png)

  -
    - 数据链路层协议规范了不同的介质上使用的帧的格式编排方式.

    - 同介质使用的协议也不同
    - 在路径沿途的每一跳,中间设备从一种介质接受帧,在解封帧,然后转发封装在新帧中的数据包.每个帧的帧头都要根据其将要经过的具体介质编排格式.

    同理，用于规范将帧放入介质中的方法也有很多种。数据链路层上的协议定义了访问不同介质的规则。这些介质访问控制技术定义了节点是否以及如何共享介质。

    实际使用的介质访问控制方法取决于：

    - 拓扑 - 节点之间的连接如何显示在数据链路层中。

    - 介质共享 - 节点如何共享介质。介质共享可以是点对点（例如 WAN 连接中的共享）或者例如 LAN 网络中的共享。

  - 物理和逻辑拓扑

    - 物理拓扑 - 是指物理连接，用于标识终端设备和基础设施设备（如路由器、交换机和无线接入点）如何互连。物理拓扑通常是点对点拓扑或星型拓扑。

    - 逻辑拓扑 - 是指网络将帧从一个节点传输到另一节点的方法。这种布局由网络节点之间的虚拟连接组成。这些逻辑信号路径是按数据链路层协议定义的。当共享介质提供不同的访问控制方法时，点对点链路的逻辑拓扑相对简单。

  - 常见物理WAN拓扑

  ![常见物理WAN拓扑](/assets/images/cisco1/4-常见的物理WAN拓扑.png)

    - 点对点 - 这是最简单的拓扑，由两个端点间的永久链路组成。因此，这是一种非常普遍的 WAN 拓扑。
    - 集中星型 - 星型拓扑的 WAN 版本，在该拓扑中一个中心站点使用点对点链路互连分支机构站点。

    - 网状 - 该拓扑可用性高，但要求每个终端系统都与其他各个系统互连。因此管理成本和物理成本都会非常高。每条链路实质上是另一节点的点对点链路。

      数据链路协议使用的介质访问方法取决于逻辑点对点拓扑，而非物理拓扑。这表示两个节点间的逻辑点对点连接可能并不一定存在于某个物理链路各端的两个物理节点之间。

  - 物理 LAN 拓扑

  ![物理LAN拓扑](//assets/images/cisco1/4-物理LAN拓扑.png)

    物理拓扑定义了终端系统的物理互连方式。在共享介质 LAN 上，终端设备可以使用以下物理拓扑互连：

    - 星型 - 将终端设备连接到中心中间设备。早期的星型拓扑使用以太网集线器互连终端设备。但现在，星型拓扑使用以太网交换机。星型拓扑安装简易、扩展性好（易于添加和删除终端设备），而且故障排除容易。

    - 扩展星型 - 在扩展星型拓扑中，额外的以太网交换机与其他星型拓扑互连。扩展星型是一种混合拓扑。
    - 总线 - 所有终端系统都相互连接，并在两端以某种形式端接。终端设备互连时不需要基础设施设备（例如交换机）。因为总线拓扑价格低廉而且安装简易，所以传统的以太网络中会使用采用同轴电缆的总线拓扑。
    - 环 - 终端系统与其各自的邻居相连，形成一个环状。与总线拓扑不同，环拓扑不需要端接。环拓扑用于传统的光纤分布式数据接口 (FDDI) 和令牌环网络。

  - 半双工和全双工
    - 半双工通信
    - 全双工通信
  - 介质访问控制方法
    - 争用访问

      WLAN、使用集线器的以太网 LAN 和传统以太网总线网络都是争用访问网络的示例。所有这些网络都在半双工模式下运行。这需要有一个进程来管理设备何时可以发送以及当多台设备同时发送时会发生什么情况。

      - CSMA/CD  载波侦听多路访问/冲突检测

      - CSMA/CA  载波侦听多路访问/冲突避免

      一定要注意，使用 __交换机的以太网 LAN__ 不使用争用系统，因为交换机和主机网卡在全双工模式下运行。

    - 受控访问

  3. 帧
    - 帧字段
        - 帧开始

        - 编址 - 表示介质上的源节点和目的节点

        - 类型 - 用于标识数据字段中的第 3 层协议
        - 控制 - 用于标识特殊流量控制服务，比如服务质量 (QoS)。
        - 数据 - 包含帧负载（即数据包报头、数据段报头和数据）。
        - 错误检测 - 这些帧字段用于进行错误检测并包含在数据之后形成帧尾。因为介质中的信号可能遭受干扰、失真或丢失，从而大幅更改这些信号所代表的位值，所以要将错误检测添加到数据链路层。

        - 帧结束

          发送节点会创建帧内容的逻辑摘要，称为循环冗余校验 (CRC) 值。此值将放入帧校验序列 (FCS) 字段中以代表帧内容。在以太网尾部，FCS 为接收节点提供一种方法，用于确定帧是否出现传输错误。
      - 第二层地址

      ![第二层数据链路地址](/assets/images/cisco1/4-第二层数据链路地址.png)

        数据链路层提供了通过共享本地介质传输帧时要用到的编址方法。此层中的设备地址称为物理地址。数据链路层地址包含在帧头中，它指定了帧在 __本地网络中的目的节点__。帧头还可能包含帧的源地址。

        与分层式第 3 层逻辑地址不同，物理地址不会表示设备位于哪个网络。相反，物理地址对于特定设备是唯一的。若将设备移至另一网络或子网，它将仍使用同一第 2 层物理地址。

        当 IP 数据包从主机到路由器、从路由器到路由器和最终从路由器到主机传输时，沿途中的每个点上都会将 IP 数据包封装到新的数据链路帧中。__每个数据链路帧包含发送帧的 NIC 卡的源数据链路地址和接收帧的 NIC 卡的目的数据链路地址__。

        如果数据必须传递到另一网段上，则需要使用中间设备，比如路由器。路由器必须根据物理地址接受帧并解封帧，以便检查分层地址或 IP 地址。路由器使用 IP 地址就能确定目的设备的网络地址以及到达该地址的最佳路径。当知道要将数据包转发到何处时，路由器会为数据包创建一个新帧，并将新帧发送到通往最终目的地的下一网段。

      - LAN和WAN上的帧

        用于特定网络拓扑的第 2 层协议取决于实施该拓扑的技术。
        数据链路层协议包括：
          - 以太网
          - 802.11 无线
          - 点对点协议 (PPP)
          - HDLC
          - 帧中继
