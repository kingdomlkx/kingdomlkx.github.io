---
title: Cisco-1-第三章 网络协议与通信
auther: 雁引愁心去
layout: post
---

## 第三章 网络协议与通信 ##

### 第 3.1 节 通信规则 ###

1. 规则
  - 规则建立
  - 消息编码
  - 消息格式和封装
  - 消息大小
  - 消息时序
  - 消息传输选项
    - 单播
    - 组播
    - 广播

### 第 3.2 节 网络协议和标准 ###

1. 协议
  - 用于规范通信的规则
  - 网络协议
  - 协议交互
    - 以太网  

      是一种网络访问协议，描述两个主要功能：_数据链路上的通信_ 和 _网络介质中数据的物理传输_ 。网络访问协议负责接收来自 IP 的数据包并将其封装为适合通过介质传输的格式。

  ![两种分层模型](/assets/images/cisco1/3-两种分层模型.png)

2. 协议簇        
  协议簇是提供全面的网络通信服务的一组协议。协议簇可能由标准组织指定或者由供应商开发。

  ![TCP/IP协议族](/assets/images/cisco1/3-TCPIP协议族.png)

  TCP/IP 协议簇
  - TCP/IP 通信过程 例:

    1. Web 服务器准备超文本标记语言 (HTML) 页面作为需要发送的数据。     

    2. 将应用程序协议 HTTP 报头添加到 HTML 数据的前面。报头包含各种信息，包括服务器所使用的 HTTP 版本和指示它有信息需要传送给 Web 客户端的状态码。(报文)        
    3. HTTP 应用层协议将 HTML 格式的网页数据传送到传输层。TCP 传输层协议用于管理单个会话，本示例中为 Web 服务器和 Web 客户端之间的单个会话。(报文段)       
    4. 接下来将 IP 信息添加到 TCP 信息的前面。IP 分配合适的源和目的 IP 地址。此信息称为 IP 数据包。(数据报)        
    5. 以太网协议将信息添加到 IP 数据包的两端，称为数据链路帧。将此帧传送到通往 Web 客户端的路径中最近的路由器上。该路由器将删除以太网信息，分析 IP 数据包，为该数据包确定最佳路径，将数据包插入新的帧中，并将其发送到通往目的地的下一个邻居路由器上。每台路由器在转发数据包之前都会删除旧的数据链路信息并添加新的数据链路信息。(数据链路帧)
    6. 现在该数据在由介质和中间设备组成的网际网络中传输。      
    7. 客户端收到包含数据的数据链路帧。每个协议报头都会得到处理，然后按与添加相反的顺序将其删除。将以太网信息处理并删除之后，接着处理并删除 IP 协议信息，然后是 TCP 信息，最后是 HTTP 信息。     
    8. 然后网页信息将传递到客户端的 Web 浏览器软件。    
3. Internet 标准组织

  - Internet 协会 (ISOC) – 负责在全世界推进 Internet 的开放式开发、发展和使用。

  - 互联网架构委员会 (IAB) - 负责 Internet 标准的整体管理和发展。
  - 互联网工程任务组 (IETF) - 负责开发、更新和维护互联网和 TCP/IP 技术。 包括用于开发新协议和更新现有协议的流程和文档，称为征求意见 (RFC) 文档。
  - 互联网研究任务组 (IRTF) - 负责 Internet 和 TCP/IP 协议相关的长期研究，包括反垃圾电子邮件研究组（Anti-Spam Research Group，ASRG）、密码技术研究组（Crypto Forum Research Group，CFRG）和对等网络研究组（Peer-to-Peer Research Group，P2PRG）等。
  - 互联网名称与数字地址分配机构 (ICANN) - 总部设在美国，负责协调 IP 地址分配、域名的管理和 TCP/IP 协议中使用的其他信息的分配。
  - 互联网编号指派机构 (IANA) - 负责监督和管理 ICANN 中的 IP 地址分配、域名管理和协议标识符。

4. 电子与通信标准组织

  - 电气电子工程师协会（IEEE，读作“I-triple-E”） –是为致力于推动诸多行业领域的技术创新和标准创建的工程师设立的组织，涉及的领域包括电力与能源、医疗保健、电信和网络。图 1 显示了与网络相关的几个标准。

  - 美国电子工业协会 (EIA) - 因其在用于安装网络设备的电线、连接器和 19 英寸机架方面的标准而知名。

  - 电信工业协会 (TIA) - 负责开发各种领域的通信标准，包括无线电设备、手机信号塔、IP 语音 (VoIP) 设备和卫星通信等。图 2 展示了符合 TIA/EIA 标准的以太网电缆的一个示例。

  - 国际电信联盟电信标准局 (ITU-T) - 是最大最早的通信标准组织之一。ITU-T 定义视频压缩、Internet 协议电视 (IPTV) 和宽带通信的标准，例如数字用户线路 (DSL)。

### 第3.3 节 网络中的数据传输 ###

1. 消息分段

  - 消息分段主要有两个优点：

      - 通过从源设备向目的设备发送一个个小片段，就可以在网络上交替发送许多不同会话，称为多路复用。单击图 1 中的每个按钮，然后单击“播放”按钮观看分段和多路复用的动画演示。

      - 分段可以增强网络通信的效率。如果由于网络故障或网络拥塞，有部分消息未能传送到目的地，则只需重新传输丢失的部分。
2. 协议数据单元     

  在通过网络介质传输应用程序数据的过程中，随着数据沿协议栈向下传递，每层都要添加各种协议信息。此过程称为封装。      

  一段数据在任意协议层的表示形式称为协议数据单元 (PDU)。在封装过程中，后续的每一层都根据使用的协议封装其从上一层接收的 PDU。在该过程的每个阶段，PDU 都以不同的名称来反映其新功能。   

3. 封装     

  在网络中发送消息时，封装过程自上而下工作。在各层，上层信息被视为封装协议内的数据。例如，TCP 数据段被视为 IP 数据包内的数据。      

4. 解封     

  接收主机上的过程与之相反，称为“解封”。解封是接收设备用来删除一个或多个协议报头的过程。数据在朝着最终用户应用程序沿协议栈向上移动的过程中被解封。     

5. 网络地址     

![网络地址](/assets/images/cisco1/3-网络地址.png)

  - 网络层源地址和目的地址 - 负责将 IP 数据包从原始源设备传输到处于同一网络或远程网络中的最终目的设备。   

  - 数据链路层源地址和目的地址 – 负责将数据链路帧从一个网络接口卡 (NIC) 传输到同一网络上的另一个 NIC。    
5. 数据链路地址     

  数据链路（或第 2 层）物理地址具有不同的作用。数据链路地址的作用是将数据链路帧从一个网络接口传输到同一网络中的另一个网络接口。      

  在 IP 数据包可以通过有线或无线网络发送之前，必须将其封装成数据链路帧，以便通过物理介质传输。      

  当 IP 数据包从主机到路由器、从路由器到路由器和最终从路由器到主机传输时，沿途中的每个点上都会将 IP 数据包封装到新的数据链路帧中。每个数据链路帧包含发送帧的 NIC 卡的源数据链路地址和接收帧的 NIC 卡的目的数据链路地址。     

  第 2 层，数据链路协议仅用于在同一网络中的 NIC 之间传输数据包。当一个 NIC 上收到第 2 层信息时，路由器会将其删除，添加新的数据链路信息，然后将数据包从通往最终目的地的路途中的退出 NIC 上转发出去。     

  IP 数据包会封装到包含数据链路信息的数据链路帧中，包括：     
    - 源数据链路地址 - 发送数据链路帧的设备 NIC 的物理地址。     
    - 目的数据链路地址 - 接收数据链路帧的 NIC 的物理地址。该地址为下一跳路由器，或最终目的设备。   
6. 同一网络中的设备

  - 网络层地址的作用        

    网络层地址，或 IP 地址，表示原始源地址和最终目的地址。IP 地址包含两部分：   

      - 网络部分 – 地址最左边的部分，表示 IP 地址是哪个网络的成员。同一网络中所有设备的地址都有相同的网络部分。

      - 主机部分 – 地址的其余部分，标识网络中的特定设备。主机部分对于网络中的每个设备都是唯一的。       

      注意：子网掩码用于将地址的网络部分与主机部分区分开来。子网掩码将在后面的章节中进行讨论。       

      在本示例中，客户端计算机 PC1 与同一 IP 网络中的 FTP 服务器进行通信。  

      源 IP 地址 - 发送设备（客户端计算机 PC1）的 IP 地址：192.168.1.110。       
      目的 IP 地址 - 接收设备（FTP 服务器）的 IP 地址：192.168.1.9。         

  - 数据链路层地址的作用          

    当 IP 数据包的发送方和接收方处于同一网络中时，数据链路帧将直接发送到接收设备。在以太网中，数据链路地址称为以太网（介质访问控制）地址。MAC 地址是以太网网卡的物理内嵌地址。

    - 源 MAC 地址 - 这是发送封装有 IP 数据包的数据链路帧的设备的数据链路地址，或以太网 MAC 地址。PC1 以太网网卡的 MAC 地址为 AA-AA-AA-AA-AA-AA，以十六进制表示法表示。
    - 目的 MAC 地址 - 当接收设备与发送设备处于同一网络中时，这是指接收设备的数据链路地址。在本示例中，目的 MAC 地址是 FTP 服务器的 MAC 地址：CC-
    CC-CC-CC-CC-CC，以十六进制表示法表示。
7. 远程网络中的设备   

 - 网络层地址的作用

    当数据包的发送方与接收方位于不同网络时，源 IP 地址和目的 IP 地址将代表位于不同网络的主机。这将由目的主机 IP 地址的网络部分来表明。

   - 源 IP 地址 - 发送设备（客户端计算机 PC1）的 IP 地址：192.168.1.110。

   - 目的 IP 地址 - 接收设备，服务器（即 Web 服务器）的 IP 地址：172.16.1.99。

 - 数据链路层地址的作用     

   当 IP 数据包的发送方和接收方位于不同网络时，以太网数据链路帧不能直接发送到目的主机，因为在发送方的网络中无法直接到达该主机。必须将以太网帧发送到称为路由器或默认网关的另一设备。在我们的示例中，默认网关是 R1。R1 有一个以太网数据链路地址与 PC1 位于同一网络中。这使 PC1 能够直接到达路由器。      

      - 源 MAC 地址 - 发送设备 PC1 的以太网 MAC 地址。PC1 以太网接口的 MAC 地址是 AA-AA-AA-AA-AA-AA。

      - 目的 MAC 地址 - 当接收设备（目的 IP 地址）与发送设备位于不同网络时，发送设备使用默认网关或路由器的以太网 MAC 地址。在本示例中，目的 MAC 地址是 R1 的以太网接口的 MAC 地址：11-11-11-11-11-11。 这是连接到 PC1 所在网络的接口。

 现在可以将封装有 IP 数据包的以太网帧传送到 R1。R1 将数据包转发到目的地（Web 服务器）。这可能意味着 R1 会将数据包转发到另一个路由器，或者如果目的地所在的网络与 R1 相连的话直接转发到 Web 服务器。           

 必须在本地网络的每台主机上配置默认网关的 IP 地址。所有指向远程网络中目的地的数据包都会发送到默认网关。
